<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="utf-8">
  <title>{{ title }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: -apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif; margin: 2rem; color: #1f2933; }
    h1 { color: #2563eb; }
    table { border-collapse: collapse; width: 100%; margin-bottom: 1.5rem; }
    th, td { border: 1px solid #d1d5db; padding: 0.5rem; text-align: left; }
    th { background: #eff6ff; }
    .degraded { color: #d97706; font-weight: 600; }
  </style>
</head>
<body>
  <h1>{{ title }}</h1>
  <p>日期：{{ date }}</p>
  {% if degraded %}
  <p class="degraded">⚠️ 数据存在缺口，以下结论仅供参考，请谨慎操作。</p>
  {% endif %}
  <section>
    <h2>主题评分</h2>
    <table>
      <thead>
        <tr>
          <th>主题</th>
          <th>总分</th>
          <th>基本面</th>
          <th>估值</th>
          <th>情绪</th>
          <th>资金</th>
          <th>事件</th>
        </tr>
      </thead>
      <tbody>
      {% for theme in themes %}
        <tr>
          <td>{{ theme.label }}</td>
          <td>{{ '%.1f' | format(theme.total) }}</td>
          <td>{{ theme.breakdown.fundamental | round(1) }}</td>
          <td>{{ theme.breakdown.valuation | round(1) }}</td>
          <td>{{ theme.breakdown.sentiment | round(1) }}</td>
          <td>{{ theme.breakdown.liquidity | round(1) }}</td>
          <td>{{ theme.breakdown.event | round(1) }}</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </section>
  <section>
    <h2>操作建议</h2>
    <ul>
    {% for action in actions %}
      <li><strong>{{ action.action }}</strong> {{ action.name }} —— {{ action.reason }}</li>
    {% endfor %}
    </ul>
  </section>
  <section>
    <h2>未来事件</h2>
    {% if events %}
      <ul>
      {% for event in events %}
        <li>{{ event.date }} · {{ event.title }} · 影响级别：{{ event.impact }}</li>
      {% endfor %}
      </ul>
    {% else %}
      <p>暂无可用事件数据。</p>
    {% endif %}
  </section>
  <footer>
    <p>报告自动生成时间：{{ generated_at }}</p>
  </footer>
</body>
</html>
